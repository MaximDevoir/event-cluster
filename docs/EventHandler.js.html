<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>EventHandler.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="EventCluster.html">EventCluster</a><ul class='methods'><li data-type='method'><a href="EventCluster.html#fire">fire</a></li></ul></li><li><a href="EventHandler.html">EventHandler</a><ul class='methods'><li data-type='method'><a href="EventHandler.html#addListener">addListener</a></li><li data-type='method'><a href="EventHandler.html#fire">fire</a></li><li data-type='method'><a href="EventHandler.html#getListeners">getListeners</a></li><li data-type='method'><a href="EventHandler.html#removeAllEvents">removeAllEvents</a></li><li data-type='method'><a href="EventHandler.html#removeEvent">removeEvent</a></li><li data-type='method'><a href="EventHandler.html#removeListener">removeListener</a></li></ul></li><li><a href="EventListener.html">EventListener</a><ul class='methods'><li data-type='method'><a href="EventListener.html#destroy">destroy</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">EventHandler.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const EventListener = require('./EventListener');
const EventCluster = require('./EventCluster');
const toString = Object.prototype.toString;

/**
 * EventHandler
 */
class EventHandler {

  constructor(clusterIdentifier, clusterContext) {
    this.events = {};
    this.cluster = null;

    if(toString.call(clusterContext) === "[object Object]") {
      this.cluster = new EventCluster(this, clusterIdentifier, clusterContext);
    }
  }

  /**
   * Get an array of functions assigned to an event.
   * If no listeners exist the event is added.
   * @param  {String} name Name of event
   * @return {Array}       Listeners of event
   */
  getListeners(name) {
    return this.events[name] || (this.events[name] = []);
  }

  /**
   * Add a function to listen for an event.
   * @param {String}   name    Name of event
   * @param {Function} fn      Executed when event for name is fired
   * @param {Object}   context Reference object
   * @return {EventListener}   Returns this
   */
  addListener(name, fn, context) {
    const listeners = this.getListeners(name);

    fn.bind(context);
    listeners.push(fn);
    return new EventListener(this, name, fn);
  }

  /**
   * Removes all instances of listener from an event
   * @param  {String}   name Event name
   * @param  {Function} fn   The function to remove
   * @return {EventHandler}  Returns this
   */
  removeListener(name, fn) {
    const listeners = this.getListeners(name);

    for(let i = listeners.length - 1; i >= 0; i--) {
      if(listeners[i] === fn) {
        listeners.splice(i, 1);
      }
    }
    return this;
  }

  /**
   * Remove a single function from a listener
   * @param  {String} name  The name of the event to remove func from
   * @return {EventHandler} Returns this
   */
  removeEvent(name) {
    delete this.events[name];
    return this;
  }

  /**
   * Resets all listeners
   * @return {EventHandler} Returns this
   */
  removeAllEvents() {
    this.events = {};
    return this;
  }

  /**
   * Fires event, all fn's listening to the event will be executed.
   * @param {String}    name    The name of the listener
   * @param {Object}    thisArg Reference
   * @param {...args}   args    Any other arguments passed will be applied to
   *                            the listening functions.
   * @return {EventHandler}     Returns this
   */
  fire(name, thisArg, ...args) {
    let clusterCode = name.substring(0, '$clusterFire__'.length);
    let clusterEvent = name;

    if(this.cluster &amp;&amp; clusterCode !== '$clusterFire__') {
      this.cluster.fire(...arguments);

      // End execution to avoid double-execution
      return this;
    } else if(this.cluster &amp;&amp; clusterCode === '$clusterFire__') {
      clusterEvent = name.slice('$clusterFire__'.length);
    }

    const listeners = this.getListeners(clusterEvent);
    listeners.forEach(listener => {
      listener.apply(thisArg, args);
    });
    return this;
  }
}

module.exports = EventHandler;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Jun 08 2016 16:55:09 GMT-0600 (Central America Standard Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
